<!DOCTYPE html>
<html>
<head>
<title>MapBBCode</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="lib/leaflet.css" />
<link rel="stylesheet" href="lib/leaflet.draw.css" />
<!--[if lte IE 8]>
    <link rel="stylesheet" href="lib/leaflet.ie.css" />
    <link rel="stylesheet" href="lib/leaflet.draw.ie.css" />
<![endif]-->
<script src="lib/leaflet.js"></script>
<script src="lib/leaflet.draw.js"></script>
<script src="lib/Bing.js"></script>
<script src="lib/mapbbcode.js"></script>
</head>
<body>
<script>
var mapBB = new MapBBCode({
    defaultPosition: [59.95, 30.3],
    defaultZoom: 13,
    fullViewHeight: 300,
    windowWidth: 800,
    windowHeight: 500,
    fullFromStart: true,
    uploadButton: true,
    createLayers: function(L) { return [
        L.tileLayer('http://129.206.74.245:8001/tms_r.ashx?x={x}&y={y}&z={z}', { name: 'OpenMapSurfer', attribution: 'Map &copy; <a href=\"http://openstreetmap.org\">OSM</a> | Tiles &copy; <a href=\"http://giscience.uni-hd.de/\">GIScience Heidelberg</a>', minZoom: 0, maxZoom: 19 }),
        MapBBCode.prototype.createOpenStreetMapLayer(),
//        L.bingLayer('Arzdiw4nlOJzRwOz__qailc8NiR31Tt51dN2D7cm57NrnceZnCpgOkmJhNpGoppU', { name: 'Bing Satellite' })
    ]}
});
</script>

<h1>[map] BBCode</h1>

<p>It is sad to see that while maps and geodata are trending, there is no reasonable solution to embed maps
in any of forum engines. Users of <a href="http://www.skyscrapercity.com/">SkyscraperCity</a>, the leading forum on
tall buildings, transport infrastructure and urban development, cannot use maps to show what they are discussing.
Cycling forums don't have route maps in their weekend journeys topics. Hikers cannot place photos taken in a recent
trip on a map. Offroad clubs still have to rely on arrays of GPS waypoints for their activities.</p>

<p>Meanwhile, recent technological advancements in web mapping, namely <a href="http://leafletjs.com">Leaflet</a>
library and its plugins, made it possible to create a simple solution for embedding maps in forums. It took a bit longer than
expected, but here is the library for parsing, displaying and editing [map] bbcode contents. With luck, this tag will
become as common on forums as [img] and [url].</p>

<div id="sample"></div>
<div style="float: right; width: 100px;">
<input type="button" value="Update" onclick="javascript:update();" style="width: 100%; height: 26px;"><br>
<input type="button" value="Edit" onclick="javascript:edit();" style="width: 100%; height: 26px;">
</div>
<textarea id="code" style="width: 490px; max-width: 490px; height: 48px;">[map]59.9342,30.3367(S); 59.4366,24.7529(F); 59.377,28.204(Border control); 59.934,30.337 59.718,30.037 59.39,28.532 59.372,27.444 59.428,26.807 59.367,26.433 59.469,26.016 59.437,24.753[/map]</textarea>

<p>Download MapBBCode JavaScript library:</p>

<ul>
<li><a href="dist/mapbbcode-1.0.0.zip">Version 1.0.0</a>: stable version, released on 31th of October, 2013</li>
<li><a href="https://github.com/MapBBCode/mapbbcode">GitHub repository</a>: latest development version, sources and examples</li>
</ul>

<p>Map BBCode can be integrated into your installation of:</p>

<ul>
<li><b>phpBB 2</b>: <a href="https://github.com/MapBBCode/mapbb-phpbb2/raw/master/dist/mapbbcode_mod.zip">Download MOD</a> (EasyMOD-compatible), <a href="https://github.com/MapBBCode/mapbb-phpbb2">Github Repository</a></li>
<li><b>phpBB 3</b>: <a href="https://www.phpbb.com/community/viewtopic.php?f=70&amp;t=2205161">MOD Discussion</a>, <a href="https://github.com/MapBBCode/mapbb-phpbb3">Github Repository</a></li>
</ul>

<p>Please help us expand this list! There is an extensive <a href="https://github.com/MapBBCode/mapbbcode/blob/master/EMBEDDING.md">documentation</a> on integrating [map] bbcode with forum engines. It doesn't even have to be a forum: <a href="https://github.com/MapBBCode/mapbbcode/blob/master/BBCODE.md">the format</a> is quite versatile. And does not rely on using <a href="#sample" onclick="javascript:replaceMap(); return true;">actual maps</a>. You can use the library in your project to display maps or to provide a complete mapping experience for your users. To showcase it, we have made an <a href="https://github.com/MapBBCode/share.mapbbcode.org">open-source</a> website to create and share user maps:</p>

<div id="share"><a href="http://share.mapbbcode.org">share.mapbbcode.org</a></div>

<p>The MapBBCode library and most examples were written by Ilya Zverev and published under WTFPL license where possible.</p>

<script>
var code = document.getElementById('code'),
    sharedRE = new RegExp('^\\s*\\[mapid\\]\\s*([a-z]+)\\s*\\[/mapid\\]\\s*$');

function update() {
    var m = sharedRE.exec(code.value);
    if( m )
        mapBB.showExternal('sample', m[1]);
    else
        mapBB.show('sample', code.value);
}

function edit() {
    mapBB.editorWindow(code.value, function(res) {
        if( res !== null ) {
            code.value = res;
            update();
        }
    });
}

update();

function replaceMap() {
    mapBB.options.defaultPosition = [66.03587,-112.80762];
    mapBB.options.defaultZoom = 5;
    mapBB.options.createLayers = function(L) {
        return [L.tileLayer('/got_hbo/{z}-{x}-{y}.jpg', { name: 'Known World', attribution: '&copy; HBO', minZoom: 3, maxZoom: 5 })];
    };
    mapBB.options.leafletOptions = { maxBounds: [[18, -180], [85, 68.3]] };
    code.value = '[map]66.6,-112.4(todo: conquer)[/map]';
    update();
}
</script>

<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(["setDomains", ["*.mapbbcode.org","*.share.mapbbcode.org"]]);
  _paq.push(["trackPageView"]);
  _paq.push(["enableLinkTracking"]);

  (function() {
    var u=(("https:" == document.location.protocol) ? "https" : "http") + "://piwik.textual.ru/";
    _paq.push(["setTrackerUrl", u+"piwik.php"]);
    _paq.push(["setSiteId", "6"]);
    var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0]; g.type="text/javascript";
    g.defer=true; g.async=true; g.src=u+"piwik.js"; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->
</body>
</html>
